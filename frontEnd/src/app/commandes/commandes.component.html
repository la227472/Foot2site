<div class="dashboard-container">
  <aside class="sidebar">
    <div class="sidebar-brand">Mon Dashboard</div>
    <div class="sidebar-menu">
      <div class="menu-item" routerLink="/profil" routerLinkActive="active">
        <mat-icon>person</mat-icon> Mon profil
      </div>
      <div class="menu-item" routerLink="/commandes" routerLinkActive="active">
        <mat-icon>shopping_bag</mat-icon> Mes commandes
      </div>
      <div class="menu-item" routerLink="/profilconfig" routerLinkActive="active">
        <mat-icon>desktop_windows</mat-icon> Mes configurations
      </div>
    </div>
  </aside>

  <main class="main-content">
    <div class="content-card">
      <h1 class="page-title">Mes commandes</h1>

      <div *ngIf="!isLoading && commandes.length === 0" class="empty-state">
        Vous n'avez pas encore passé de commandes.
      </div>

      <div class="config-list" *ngIf="!isLoading">
        <div *ngFor="let cmd of commandes" 
             class="config-group" 
             [class.expanded]="expandedOrderId === cmd.id">
          
          <div class="config-header" (click)="toggleExpand(cmd.id)">
                <div class="config-info">
                    <span class="config-name">Commande #{{ cmd.id }} — {{ cmd.nomConfigurationArchive }}</span>
                    <span class="config-date">
                    Passée le {{ cmd.dateCommande | date:'dd/MM/yyyy à HH:mm' }}
                    </span>
                </div>

                <div class="order-price-tag">
                    {{ cmd.prixConfiguration.toFixed(2) }} €
                </div>

                <div class="actions">
                    <mat-icon class="arrow">
                    {{ expandedOrderId === cmd.id ? 'expand_less' : 'expand_more' }}
                    </mat-icon>
                </div>
        </div>
          
          <div class="config-details" *ngIf="expandedOrderId === cmd.id">
  <div class="archive-details-box">
    <p class="archive-label">Détail des composants au moment de l'achat :</p>
    
    <div class="component-row archive-row" *ngFor="let detailStr of splitDetails(cmd.detailsComposantsArchive)">
      
      <ng-container *ngIf="parseComponentDetail(detailStr) as comp">
        <span class="comp-name">{{ comp.nom }}</span>
        
        <div class="comp-stats">
          <span class="comp-price">{{ comp.prix }}</span>
          <mat-icon style="color: #2ecc71;">check_circle</mat-icon>
        </div>
      </ng-container>

    </div>
  </div>
</div>
        </div>
      </div>

      <div *ngIf="isLoading" class="loader">Chargement de vos commandes...</div>
    </div>
  </main>
</div>
